{{ define "main" }}
<section class="section" aria-labelledby="ttl">
  <div class="contain">
    <h1 id="ttl">{{ .Title }}</h1>

    <div class="cards">
      {{ range .RegularPages.ByDate.Reverse }}

        {{/* 1) front matter の thumbnail を優先してページバンドルから取得
              2) 無ければ "thumb*" にマッチする最初の画像を使う */}}
        {{ $thumbRes := or (.Resources.GetMatch (.Params.thumbnail | default "")) (.Resources.GetMatch "thumb*") }}

        <a class="card" href="{{ .RelPermalink }}" data-tags='{{ jsonify (.Params.tags | default (slice)) }}'>
          <figure class="card-thumb" aria-hidden="true">
            {{ with $thumbRes }}
              <img class="card-thumb-img" src="{{ .RelPermalink }}" alt="" loading="lazy">
            {{ else }}
              <div class="ph">NO IMAGE</div>
            {{ end }}
          </figure>

          <div class="card-body">
            <h3 class="card-title">{{ .Title }}</h3>
            {{ $desc := or .Params.description .Description }}
            {{ with $desc }}<p class="card-desc">{{ . }}</p>{{ end }}


            {{ with .GetTerms "tags" }}
              <ul class="tags">
                {{ range . }}<li><a href="{{ .RelPermalink }}">{{ .LinkTitle }}</a></li>{{ end }}
              </ul>
            {{ end }}
          </div>
        </a>

      {{ end }}
    </div>
  </div>
</section>
{{ end }}
